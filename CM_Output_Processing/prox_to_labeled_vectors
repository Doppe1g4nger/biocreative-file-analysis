import AnnotatedArticle as aa
import pickle
import numpy as np
import scipy.stats as stats
import pylab as pl


def load_obj(name):
    with open(name, 'rb') as f:
        return pickle.load(f)

if __name__ == "__main__":
    prox_dictionary_loc = r"C:\Users\Adam\Documents\MSU REU\FT_Post-Processed\Features\FT_GO-old_Feat_proxtest.pkl"
    labeled_positives_loc = r'C:\Users\Adam\Documents\MSU REU\FT_Post-Processed\TrainingCanonicalNames_ToDocID_dicts\BP_ft_train_canon_to_docid_dict.pkl'
    output_pickle = r"C:\Users\Adam\Documents\MSU REU\FT_Post-Processed\Features\Training_Features_Vectors\FT_GO-old_proxtest_Train_FV.pkl"
    prox_dict = load_obj(prox_dictionary_loc)
    labeled_pos_dict = load_obj(labeled_positives_loc)
    features = []
    labels = []

    for kinase in prox_dict:
        for doc in prox_dict[kinase]:
            try:
                doc_id = doc[0]
                if doc_id in labeled_pos_dict[kinase]:
                    labels.append(1)
                else:
                    labels.append(0)
                if len(labels) % 1000 == 0:
                    print(len(labels))
                features.append([doc[1], doc[2], doc[3], doc[4]])
            except KeyError:
                print("KeyError")

    fl_tuple = (labels, features)
    with open(output_pickle, 'wb') as output_file:
        pickle.dump(fl_tuple, output_file, pickle.HIGHEST_PROTOCOL)
